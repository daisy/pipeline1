<HTML><HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" />
<META NAME="generator" CONTENT="Skype" />
</HEAD><BODY>
<style type='text/css' media='all'> html { margin: 0; padding: 0; } head { display: none; } body { margin: 10px 10px 30px; padding: 0; font: normal 75% Tahoma, Verdana, Helvetica, sans-serif; color: #000; } h1 { font-size: 1.2em; font-weight: 600; margin: 0; } h2 { font-size: 1.2em; font-weight: 600; margin: 0; } h3 { font-size: 1.1em; font-weight: 600; } dl, dt, dd { margin: 0; padding: 0; width: auto; display: block; } dt { height: 20px; line-height: 20px; font-weight: bold; position: relative; } dt span { position: absolute; right: 0; top: 0; font-size: 0.8em; font-weight: normal; padding-right: 10px; } dd { margin: 0.5ex 0 1ex 10px; position: relative; } dd span { position: absolute; right: 0; top: 0; font-size: 0.8em; font-weight: normal; padding-right: 10px; } dt.remote { padding-left: 10px; background: #D5E6FF url(http://goodies.skype.com/graphics/chathistory/blue_left.png) left center no-repeat; } dt.remote span { background: #D5E6FF url(http://goodies.skype.com/graphics/chathistory/blue_right.png) right center no-repeat; } dt.local { padding-left: 10px; background: #DDD url(http://goodies.skype.com/graphics/chathistory/grey_left.png) left center no-repeat; } dt.local span { background: #DDD url(http://goodies.skype.com/graphics/chathistory/grey_right.png) right center no-repeat; } dt.info { background: #F0EAAA url(http://goodies.skype.com/graphics/chathistory/info_left.png) left center no-repeat; margin: 1em 0; height: 25px; line-height: 25px; text-align: center; font-weight: normal; padding-left: 30px; } dt.info span { position: relative; height: 25px; display: block; float: none; font-size: inherit; background: transparent url(http://goodies.skype.com/graphics/chathistory/info_right.png) right center no-repeat; padding-right: 30px; } dd dl { padding: 1em 0 1em 1em; }</style><a href='http://www.skype.com/' title='Visit the Skype website.'><img src='http://www.skype.com/gfx/darkred/header/header_logo.gif' alt='Skype' border='0' height='50' /></a><br /><h1>Chat History with <a href='callto://#romain.deltour/$linus.ericson;7a01fbb5e3ebfa54' title=#romain.deltour/$linus.ericson;7a01fbb5e3ebfa54>Linus Ericson | let me know when you have time to.. (#romain.deltour/$linus.ericson;7a01fbb5e3ebfa54)</a></h1><p>Created on 2007-04-27 12:17:16.</p><dl><dd></dd><h3>2007-04-27</h3><dt class="local">Romain Deltour: <span>10:48:27</span></dt><dd>Hi Linus</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>10:48:40</span></dt><dd>hello</dd><dt class="local">Romain Deltour: <span>10:48:56</span></dt><dd>let me know when you have time to have a little chat on tasks &amp; events</dd><dt class="local">Romain Deltour: <span>10:49:34</span></dt><dd>(btw, I've just commited the fix to the multi-task bug we had yesterday)</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>10:51:26</span></dt><dd>I haven't had any time to look at the tasks end events yet. Let me just update the pipeline and the gui from the SVN so we're talking about the same code...</dd><dt class="local">Romain Deltour: <span>10:52:00</span></dt><dd>ok</dd><dt class="local">Romain Deltour: <span>10:52:12</span></dt><dd>we can have this chat after lunch if you prefer</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>11:17:04</span></dt><dd>sorry for not responding, I was busy running Narrator from the GUI. :-). I'm ready now if you are.</dd><dt class="local">Romain Deltour: <span>11:29:42</span></dt><dd>alright ;)</dd><dt class="local">Romain Deltour: <span>11:30:00</span></dt><dd>did it work (the Narrator) ?</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>11:31:15</span></dt><dd>yes! I got the progress wasn't reported the second time XMLDetection was run though, but that's what we're going to discuss now, right?</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>11:31:48</span></dt><dd>sorry, strike the "I got" in the beginning..</dd><dt class="local">Romain Deltour: <span>11:32:19</span></dt><dd>exactly...</dd><dt class="local">Romain Deltour: <span>11:32:38</span></dt><dd>so, let me try to sum up the problem</dd><dt class="local">Romain Deltour: <span>11:33:07</span></dt><dd>when a job is run, the transformer object is created (you were right yesterday by the way)</dd><dt class="local">Romain Deltour: <span>11:33:14</span></dt><dd>the transformer send events</dd><dt class="local">Romain Deltour: <span>11:33:47</span></dt><dd>the StateManager catches this events and try to get a TaskInfo from the transformer object</dd><dt class="local">Romain Deltour: <span>11:34:11</span></dt><dd>a TaskInfo is hold by a JobInfo, which is a wrapper around a Job</dd><dt class="local">Romain Deltour: <span>11:34:35</span></dt><dd>a TaskInfo has the name of the Task it represents</dd><dt class="local">Romain Deltour: <span>11:35:04</span></dt><dd>now, there's something that's still messy in my mind:</dd><dt class="local">Romain Deltour: <span>11:35:54</span></dt><dd>a Script is the in memory representation of a script file, and a Job is the instance of a script (i.e. a script with parameters set, and alledgedly ready to be run)</dd><dt class="local">Romain Deltour: <span>11:36:36</span></dt><dd>so, I would expect the same kind of dichotomy for transfomers, tasks and whatever else objects at stake</dd><dt class="local">Romain Deltour: <span>11:38:41</span></dt><dd>Yesterday we talked about associating tasks to transformers</dd><dt class="local">Romain Deltour: <span>11:39:30</span></dt><dd>I'm no longer sure that this would be enough: a task belongs to a script, and so there is no way to retrieve the associated job...</dd><dt class="local">Romain Deltour: <span>11:40:18</span></dt><dd>I think all of this does not have a strong impact here because of sequential run, but while we're looking at it, let's have parallelization in mind...</dd><dt class="local">Romain Deltour: <span>11:40:23</span></dt><dd>what do you think ?</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>11:43:03</span></dt><dd>So you would like the information about the job as well when you get a TaskMessageEvent</dd><dt class="local">Romain Deltour: <span>11:44:30</span></dt><dd>ideally yes</dd><dt class="local">Romain Deltour: <span>11:45:06</span></dt><dd>state/progress events are runtime objects, that means that they are only run in the context of a job</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>11:47:04</span></dt><dd>Yes, I see. I think it's doable,</dd><dt class="local">Romain Deltour: <span>11:47:34</span></dt><dd>in my code, I store the currently running job and currently running task in a map (the key is the thread running the sequence of jobs)</dd><dt class="local">Romain Deltour: <span>11:48:07</span></dt><dd>the currently running job is got from JobChangedEvent.getSource()</dd><dt class="local">Romain Deltour: <span>11:48:30</span></dt><dd>the tricky part is for currently running Task, where I use:</dd><dt class="local">Romain Deltour: <span>11:48:33</span></dt><dd>String transName = transformer.getTransformerInfo().getPackageName();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterator&lt;TaskInfo&gt; iter = runningJob.getTasks().iterator();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (iter.hasNext() &amp;&amp; runningTask == null) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TaskInfo info = iter.next();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (info.getName().equals(transName)) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runningTask = info;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>11:49:12</span></dt><dd>We just have to pass the task *and* the job to the TransformerHandler in Runner.java</dd><dt class="local">Romain Deltour: <span>11:49:15</span></dt><dd>actually I don't need to retrieve the job from the event, as I already have the currently running job</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>11:50:16</span></dt><dd>oh, so you mean that information about the task would be enough?</dd><dt class="local">Romain Deltour: <span>11:50:54</span></dt><dd>I'm only concerned about the current status of the API where Task is used either as declarative objects (mapping the script file &lt;task&gt; xml element) and as runtime objects (representing the instanciated task of a Job)</dd><dt class="local">Romain Deltour: <span>11:52:08</span></dt><dd>so: <BR>
- for me (GUI), the information about a task would be enough, given I'm already in a job context<BR>
- BUT, since we are refactoring a bit, do we want to fix potential multi-threading weak points ?</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>11:55:45</span></dt><dd>right, I had to switch back to the source to understand what you were saying, but I see the problem now.</dd><dt class="local">Romain Deltour: <span>11:56:10</span></dt><dd>a question to help me clarify my mind :)<BR>
- given a job Ja that is based on script S which contains the task T<BR>
- given a job Jb that is based on script S which contains the task T<BR>
<BR>
If we refactor the event so that a task is get-able from the TransformerEvent, am I right when I think that for both jobs the same object is returned ?</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>11:58:29</span></dt><dd>yes exactly, and you start having problems when you look at the task parameters</dd><dt class="local">Romain Deltour: <span>11:59:30</span></dt><dd>what kind of problems ? my understanding is that the same task object is used, but in a different state, i.e. with a different set of parameters</dd><dt class="local">Romain Deltour: <span>12:00:07</span></dt><dd>would it be better and doable to have 2 different objects for script tasks and job tasks ?</dd><dt class="local">Romain Deltour: <span>12:01:23</span></dt><dd>maybe it's overkill for now, but I would say it would be required for parallelization</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>12:01:44</span></dt><dd>but the parameters are instance variables inside the task, so if the same task is used, you get problems.</dd><dt class="local">Romain Deltour: <span>12:02:44</span></dt><dd>you mean you get problems if used in parallel, right ?</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>12:02:58</span></dt><dd>It would certainly be betterto have different script tasks and job tasks, and probably doable as well, it's just a matter of effort</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>12:03:10</span></dt><dd>yes, when run in parallel</dd><dt class="local">Romain Deltour: <span>12:04:11</span></dt><dd>(please wait, I'm updating Markus on our chat)</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>12:07:06</span></dt><dd>What if I refactor the TransformerMessageEvent to TaskMessageEvent now, and tackle the jobTask/scriptTask later?</dd><dt class="local">Romain Deltour: <span>12:08:45</span></dt><dd>we're asking ourselves the same question here</dd><dt class="local">Romain Deltour: <span>12:09:13</span></dt><dd>markus asks: how heavy is the job task / script task refactoring ?</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>12:10:04</span></dt><dd>good question :-)</dd><dt class="local">Romain Deltour: <span>12:11:02</span></dt><dd>:)</dd><dt class="local">Romain Deltour: <span>12:12:26</span></dt><dd>Markus: let's do the simple part now (TransEvent -&gt; TaskEvent), and see how easy it goes</dd><dt class="local">Romain Deltour: <span>12:12:44</span></dt><dd>let's keep the other refactoring in mind, and look at it if we have extra time</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>12:13:36</span></dt><dd>yep, sounds good. I'll probably commit that refactoring sometime after lunch.</dd><dt class="local">Romain Deltour: <span>12:13:48</span></dt><dd>ok, great</dd><dt class="local">Romain Deltour: <span>12:14:29</span></dt><dd>I'll keep you updated when the GUI is fixed after the refactoring, so that you can try the Narrator</dd><dt class="local">Romain Deltour: <span>12:14:40</span></dt><dd>session closed ?</dd><dt class="remote"><a href="callto://linus.ericson" title="linus.ericson">Linus Ericson</a>: <span>12:15:08</span></dt><dd>Cool. I'm going for lunch!</dd><dt class="local">Romain Deltour: <span>12:15:26</span></dt><dd>ok, have a good lunch then ;)</dd></dl><A NAME="end_of_document"></A></BODY></HTML>
